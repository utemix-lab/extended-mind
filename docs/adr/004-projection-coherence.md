# ADR-004: Согласованность визуальных проекций

**Статус:** Принято  
**Дата:** 2026-01-27

---

## Signature

- [x] **perception-ontology-split** — разделение восприятия и онтологии
- [x] **self-aware-not-narcissistic** — система знает о себе, но не говорит интерфейсом

---

## Контекст

Узел канонического графа может иметь несколько визуальных проекций в интерфейсе (узел на графе, виджет в панели, карточка, элемент списка и т.д.). Возникает вопрос: как должны взаимодействовать эти проекции?

## Решение

**Инвариант:**

> Узел канонического графа может иметь несколько визуальных проекций.  
> Система обеспечивает согласованность внимания между этими проекциями  
> через правила синхронизации (подсветка, фокус, навигация).

### Что это значит

1. Если пользователь взаимодействует с одной проекцией узла — все остальные проекции этого узла реагируют согласованно.
2. Конкретная реализация (цвет, анимация, звук) определяется рендером, не каноном.
3. Канон хранит только идентичность узла (`id`), не способ его отображения.

### Что это НЕ значит

- ❌ Канон не хранит правила подсветки
- ❌ RAG не индексирует визуальное поведение
- ❌ Онтология не зависит от интерфейса

## Последствия

**Положительные:**
- Канон остаётся чистым (только смысл и связи)
- Правило переживёт смену рендеров (dream-graph → Godot → другое)
- Система может объяснить свою архитектуру

**Отрицательные:**
- Рендеры должны явно реализовывать синхронизацию
- Нужна документация для новых рендеров

## Реализация

- **contracts/** — конкретные правила синхронизации для каждого рендера
- **policy/** — системный узел, фиксирующий существование этого правила
- **ADR/** — данный документ (почему принято решение)

---

## Ключевая формула

> Система знает, что у неё есть образы.  
> Она знает, что образы должны быть согласованы.  
> Но она не знает, как именно они нарисованы.
